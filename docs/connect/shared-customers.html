<!DOCTYPE html>
<html lang="en">

<!-- Mirrored from stripe.com/docs/connect/shared-customers by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 09 Feb 2015 07:33:13 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Shared Customers</title>
    <link rel="stylesheet" type="text/css" href="../../assets/site-ea99019a1bc27872a48d1149a4785b01.css" media="screen" />
    <script type="text/javascript">
        var _sf_startpt=(new Date()).getTime()
        var APIValues = {};
    </script>
    <script type="application/json" id="mixpanel_config">{&quot;identifier&quot;:&quot;eb71b6171a4f7ed97de9b7a0395b7ca5&quot;}</script>
<script type="application/json" id="analytics_config">{}</script>
<script src="../../../www.googleadservices.com/pagead/f.txt"></script>
<script src="../../assets/external_analytics-a9e3d39cd6110aa8c184d9c1f2e5777e.js"></script>
<script src="../../assets/qframe-cb903dc9166e266dc7d9f11d44f5e81a.js"></script>

    <link rel="shortcut icon" href="https://stripe.com/favicon.ico">

    <!--[if lt IE 9]>
    <script src="/assets/html5shiv-17761200a17ebcb716dda86cca6d2472.js"></script>
    <![endif]-->
    <script type="text/javascript" src="../../../use.typekit.net/gbh7uto.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
    
</head>
<body id="documentation">

  <div id="header">
    <h1><a href="https://stripe.com/">Stripe</a></h1>
    <div class="navigation">
    <div class="signin"><a id='signin' href="https://dashboard.stripe.com/login"><span>Sign In</span></a></div>

  <ul class="global">
    <li><a href="https://stripe.com/docs" class="selected">Documentation</a></li>
    <li><a href="https://support.stripe.com/">Help &amp; Support</a></li>
  </ul>
</div>

  </div><!-- #header -->

  <section id="doc">

    <nav>

      <h1 class="getting-started">Documentation</h1>
      <ul>
        <li class="unselected">
          <a href="https://stripe.com/docs">Getting Started</a>
        </li>
          <li class="unselected sub">
            <a href="../tutorials/checkout.html">Embedded Form</a>
          </li>
          <li class="unselected sub">
            <a href="../tutorials/forms.html">Custom Forms</a>
          </li>
          <li class="unselected sub">
            <a href="../mobile.html">Mobile Apps</a>
          </li>

        <li class="unselected">
          <a href="../tutorials/charges.html">Charging Cards</a>
        </li>

        <li class="unselected">
          <a href="../tutorials/sending-transfers.html">Sending Transfers</a>
        </li>

        <li class="unselected">
          <a href="../tutorials/dashboard.html">Your Account</a>
        </li>
      </ul>

      <h1 class="references">References</h1>
      <ul>
        <li class="unselected">
          <a href="../stripe.html">Stripe.js</a>
        </li>
        <li class="unselected">
          <a href="../checkout.html">Checkout</a>
        </li>
        <li class="unselected">
          <a href="../webhooks.html">Webhooks</a>
        </li>
        <li class="unselected">
          <a href="../fraud.html">Fraud Protection</a>
        </li>
        <li class="unselected">
          <a href="../testing.html">Testing</a>
        </li>
        <li class="unselected">
          <a href="../examples.html">Examples</a>
        </li>
        <li class="unselected">
          <a href="../upgrades.html">API Upgrades</a>
        </li>
        <li class="unselected">
          <a href="../libraries.html">API Libraries</a>
        </li>
        <li class="unselected">
          <a href="../guides/file-upload.html">File Upload Guide</a>
        </li>
        <li class="unselected">
          <a href="../api.html" class="external" target="_blank">
            Full API Reference
          </a>
        </li>
      </ul>

      <h1 class="subscriptions">Subscriptions</h1>
      <ul>
        <li class="unselected">
          <a href="../subscriptions.html">Overview</a>
        </li>
        <li class="unselected">
          <a href="../tutorials/subscriptions.html">Getting Started</a>
        </li>
        <li class="unselected">
          <a href="../guides/subscriptions.html">Integration Guide</a>
        </li>
      </ul>

      <h1 class="connect">Connect</h1>
      <ul>
        <li class="unselected">
          <a href="../connect.html">Overview</a>
        </li>
        <li class="unselected">
          <a href="getting-started.html">Getting Started</a>
        </li>
        <li class="unselected">
          <a href="oauth.html">Integrating OAuth</a>
        </li>
        <li class="unselected">
          <a href="collecting-fees.html">Collecting Fees</a>
        </li>
        <li class="selected">
          <a href="shared-customers.html">Shared Customers</a>
        </li>
        <li class="unselected">
          <a href="reference.html">Reference</a>
        </li>
      </ul>

      <h1 class="disputes">Disputes</h1>
      <ul>
        <li class="unselected">
          <a href="https://stripe.com/help/disputes-overview">Overview</a>
        </li>
        <li class="unselected">
          <a href="../guides/dispute-evidence.html">Submitting Evidence</a>
        </li>
        <li class="unselected">
          <a href="https://stripe.com/help/dispute-types">Dispute Types</a>
        </li>
        <li class="unselected">
          <a href="https://stripe.com/help/disputes">FAQ</a>
        </li>
      </ul>


      <h1 class="faq"><abbr title="Frequently Asked Questions">FAQ</abbr></h1>
      <ul>
        <li class="unselected">
          <a href="https://stripe.com/help/transfers">Getting Paid</a>
        </li>
        <li class="unselected">
          <a href="https://stripe.com/help/ssl">SSL/TLS</a>
        </li>
        <li class="unselected">
          <a href="https://stripe.com/help/security">Security</a>
        </li>
      </ul>

      <h1 class="more">More</h1>
      <ul>
        <li class="unselected">
          <a href="https://stripe.com/help/contact">Contact</a>
        </li>
        <li class="unselected">
          <a href="https://stripe.com/global">Global Users</a>
        </li>
        <li class="unselected">
          <a href="https://stripe.com/gallery">Gallery</a>
        </li>
        <li class="last unselected">
          <a href="../integrations.html">Integrations</a>
        </li>
      </ul>

    </nav>

    <section id="content">
      <section id="details">

    <header>
        <h1>Shared Customers</h1>
        <p>
          With <a href="../connect.html">Stripe Connect</a>, you can save your customers' payment information for reuse in any of your connected accounts.
          If you need help, check out our answers to <a href="https://support.stripe.com/">common questions</a> or chat live with other developers in #stripe on freenode.

        </p>
    </header>

    <article>

    <p>For some applications, it's useful to reuse your customers' payment information across your connected accounts. For example, a customer who makes a purchase from one of your connected sellers wouldn't need to re-enter their credit card details to purchase from another seller.</p>

    <p>With Stripe Connect, this is possible by storing all Stripe <a href="../api.html#customers">customer objects</a> on the application owner's account. Whenever you'd like to reuse customer payment information, you'll make an extra <a href="../api.html#create_card_token">token creation</a> API request to fetch the relevant data from Stripe.</p>

    <h1 id="storing-customers">Storing Stripe customers</h1>

    <p>
      Normally, without shared customers, you would save the Stripe <a href="../api.html#customers">customer objects</a> on each individual Stripe account. To share customers, you'll instead save the customers on your (the application owner) Stripe account.</p>

    <p><strong>Be sure to use your own secret and publishable keys instead of the OAuth <code>access_token</code> and <code>stripe_publishable_key</code> you get back for your user in the connect flow.</strong> You want to save the customer objects on your own Stripe account, not on your users' accounts.
    </p>

    <section class="code-example">
      <nav class="lang-control">
        <a href="https://stripe.com/docs/connect/.">ruby</a>
        <a href="https://stripe.com/docs/connect/.">python</a>
        <a href="https://stripe.com/docs/connect/.">php</a>
        <a href="https://stripe.com/docs/connect/.">node</a>
      </nav>
      <div class="terminal-wrap" data-action="tutorial_connect_store_customer">
        <pre><code><div class="terminal"></div></code></pre>
      </div>
    </section>


    <h1 id="making-a-charge">Charging a customer</h1>

    <p>
      When you're ready to charge a saved customer, you'll need:
    </p>

    <ul>
      <li>The <code>access_token</code> for the Stripe user you're making the charge for</li>
      <li>The customer ID (it looks something like <code>cus_ScUCco6M4IByCAOl</code>) of the customer you're charging. Note that the customer object <strong>must</strong> be stored on the application owner's Stripe account.</li>
      <li>The card ID for that customer, if you want to charge a specific card rather than the default.</li>
    </ul>

    <p>Make a <a href="../api.html#create_card_token">create token</a> API request, passing in the customer ID (and optionally, the card ID):</p>

    <section class="code-example">
      <nav class="lang-control">
        <a href="https://stripe.com/docs/connect/.">ruby</a>
        <a href="https://stripe.com/docs/connect/.">python</a>
        <a href="https://stripe.com/docs/connect/.">php</a>
        <a href="https://stripe.com/docs/connect/.">node</a>
      </nav>
      <div class="terminal-wrap" data-action="tutorial_connect_reuse_customer">
        <pre><code><div class="terminal"></div></code></pre>
      </div>
    </section>

    <p>
    Like a regular token creation, this returns a token that acts as a credit card number. You can use the token to create a <a href="../api.html#create_charge">one-time charge</a> or even <a href="../api.html#create_customer">save the customer</a> (again) to your user's account.
    </p>

  </article>
</section>


    </section>

  </section><!-- #documentation -->

  <div id="footer">
    <div class="country-dropdown-view">
        <a class="select">
            <span>
                <img src="../../img/flags/us.png" width="23" height="17" data-hires="true" />
                <strong>United States</strong>
            </span>
        </a>

        <div class="popover">
            <div class="arrow"></div>
            <h4>Select your Country</h4>
            <ul>
                    <li>
                        <a href="https://stripe.com/country?country=AU&amp;redirect=/docs/connect/shared-customers" >
                            <img src="../../img/flags/au.png" width="23" height="17" data-hires="true" />
                            <span>Australia</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://stripe.com/country?country=CA&amp;redirect=/docs/connect/shared-customers" >
                            <img src="../../img/flags/ca.png" width="23" height="17" data-hires="true" />
                            <span>Canada</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://stripe.com/country?country=GB&amp;redirect=/docs/connect/shared-customers" >
                            <img src="../../img/flags/gb.png" width="23" height="17" data-hires="true" />
                            <span>United Kingdom</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://stripe.com/country?country=IE&amp;redirect=/docs/connect/shared-customers" >
                            <img src="../../img/flags/ie.png" width="23" height="17" data-hires="true" />
                            <span>Ireland</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://stripe.com/country?country=US&amp;redirect=/docs/connect/shared-customers" class="selected">
                            <img src="../../img/flags/us.png" width="23" height="17" data-hires="true" />
                            <span>United States</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://stripe.com/country?country=AT&amp;redirect=/docs/connect/shared-customers" >
                            <img src="../../img/flags/at.png" width="23" height="17" data-hires="true" />
                            <span>Austria</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://stripe.com/country?country=BE&amp;redirect=/docs/connect/shared-customers" >
                            <img src="../../img/flags/be.png" width="23" height="17" data-hires="true" />
                            <span>Belgium</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://stripe.com/country?country=DK&amp;redirect=/docs/connect/shared-customers" >
                            <img src="../../img/flags/dk.png" width="23" height="17" data-hires="true" />
                            <span>Denmark</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://stripe.com/country?country=FI&amp;redirect=/docs/connect/shared-customers" >
                            <img src="../../img/flags/fi.png" width="23" height="17" data-hires="true" />
                            <span>Finland</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://stripe.com/country?country=FR&amp;redirect=/docs/connect/shared-customers" >
                            <img src="../../img/flags/fr.png" width="23" height="17" data-hires="true" />
                            <span>France</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://stripe.com/country?country=DE&amp;redirect=/docs/connect/shared-customers" >
                            <img src="../../img/flags/de.png" width="23" height="17" data-hires="true" />
                            <span>Germany</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://stripe.com/country?country=IT&amp;redirect=/docs/connect/shared-customers" >
                            <img src="../../img/flags/it.png" width="23" height="17" data-hires="true" />
                            <span>Italy</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://stripe.com/country?country=LU&amp;redirect=/docs/connect/shared-customers" >
                            <img src="../../img/flags/lu.png" width="23" height="17" data-hires="true" />
                            <span>Luxembourg</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://stripe.com/country?country=NL&amp;redirect=/docs/connect/shared-customers" >
                            <img src="../../img/flags/nl.png" width="23" height="17" data-hires="true" />
                            <span>Netherlands</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://stripe.com/country?country=NO&amp;redirect=/docs/connect/shared-customers" >
                            <img src="../../img/flags/no.png" width="23" height="17" data-hires="true" />
                            <span>Norway</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://stripe.com/country?country=ES&amp;redirect=/docs/connect/shared-customers" >
                            <img src="../../img/flags/es.png" width="23" height="17" data-hires="true" />
                            <span>Spain</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://stripe.com/country?country=SE&amp;redirect=/docs/connect/shared-customers" >
                            <img src="../../img/flags/se.png" width="23" height="17" data-hires="true" />
                            <span>Sweden</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://stripe.com/country?country=CH&amp;redirect=/docs/connect/shared-customers" >
                            <img src="../../img/flags/ch.png" width="23" height="17" data-hires="true" />
                            <span>Switzerland</span>
                        </a>
                    </li>
          </ul>
        </div>
    </div>


    <p><a href="https://stripe.com/">&copy; Stripe</a></p>

    <ul>
        <li><a href="https://status.stripe.com/"><span>System Status</span></a></li>
        <li><a href="https://stripe.com/about">About</a></li>
        <li><a href="https://stripe.com/blog"><span>Blog</span></a></li>
        <li><a href="https://stripe.com/jobs"><span>Jobs</span></a></li>
        <li><a href="http://twitter.com/stripe">Twitter</a></li>
    </ul>
    <ul class="lesser">
        <li><a href="https://stripe.com/terms">Terms of Service</a></li>
        <li><a href="https://stripe.com/privacy">Privacy Policy</a></li>
    </ul>
</div>
<div class="country-dropdown-overlay"></div>

    <script src="../../assets/jquery-47d53801b9f61ca8a21dcc2571aeb3ec.js"></script>
    <script src="../../assets/shared-3abadcaa3af6e785a085062e45894014.js"></script>

<script src="../../assets/footer_analytics-6e8fc3677422b1ab0ef7aca057103605.js"></script>

<noscript>
  <div style="display:inline;">
  <img height="1" width="1" style="border-style:none;" alt="" src="https://googleads.g.doubleclick.net/pagead/viewthroughconversion/1008370075/?value=0&amp;guid=ON&amp;script=0"/>
  </div>
</noscript>


    <script src="../../assets/tutorial-157e244e708a25090e620c16535e5350.js"></script>
  <script type="text/javascript">
      var APIValues = {};
          APIValues["ruby"] = {};
              APIValues["ruby"]["tutorial_connect_store_customer"] = "\u003Cspan class=\"highlight_js ruby\"\u003E# Set your secret key: remember to change this to your live secret key in production\n# See your keys here https://dashboard.stripe.com/account\nStripe.api_key = \u0026quot;sk_test_BQokikJOvBiI2HlWgH4olfQ2\u0026quot;\n\n# Get the credit card details submitted by the form\ntoken_id = params[:stripeToken]\n\n# Create a Customer\ncustomer = Stripe::Customer.create(\n  :card =\u0026gt; token_id,\n  :description =\u0026gt; \u0026quot;payinguser@example.com\u0026quot;\n)\u003C/span\u003E";
              APIValues["ruby"]["tutorial_connect_reuse_customer"] = "\u003Cspan class=\"highlight_js ruby\"\u003E# Create a Token from the existing customer on the application\u0026#39;s account\nStripe::Token.create(\n  {:customer =\u0026gt; CUSTOMER_ID, :card =\u0026gt; CARD_ID},\n  ACCESS_TOKEN # user\u0026#39;s access token from the Stripe Connect flow\n)\u003C/span\u003E";
          APIValues["python"] = {};
              APIValues["python"]["tutorial_connect_store_customer"] = "\u003Cspan class=\"highlight_js python\"\u003E# Set your secret key: remember to change this to your live secret key in production\n# See your keys here https://dashboard.stripe.com/account\nstripe.api_key = \u0026quot;sk_test_BQokikJOvBiI2HlWgH4olfQ2\u0026quot;\n\n# Get the credit card details submitted by the form\ntoken_id = request.POST[\u0026#39;stripeToken\u0026#39;]\n\n# Create a Customer\ncustomer = stripe.Customer.create(\n    card=token_id,\n    description=\u0026quot;payinguser@example.com\u0026quot;\n)\u003C/span\u003E";
              APIValues["python"]["tutorial_connect_reuse_customer"] = "\u003Cspan class=\"highlight_js python\"\u003E# Create a Token from the existing customer on the application\u0026#39;s account\nstripe.Token.create(\n  customer=CUSTOMER_ID,\n  card=CARD_ID,\n  api_key=ACCESS_TOKEN # user\u0026#39;s access token from the Stripe Connect flow\n)\u003C/span\u003E";
          APIValues["php"] = {};
              APIValues["php"]["tutorial_connect_store_customer"] = "\u003Cspan class=\"highlight_js php\"\u003E// Set your secret key: remember to change this to your live secret key in production\n// See your keys here https://dashboard.stripe.com/account\nStripe::setApiKey(\u0026quot;sk_test_BQokikJOvBiI2HlWgH4olfQ2\u0026quot;);\n\n// Get the credit card details submitted by the form\n$token_id = $_POST[\u0026#39;stripeToken\u0026#39;];\n\n// Create a Customer\n$customer = Stripe_Customer::create(array(\n  \u0026quot;card\u0026quot; =\u0026gt; $token_id,\n  \u0026quot;description\u0026quot; =\u0026gt; \u0026quot;payinguser@example.com\u0026quot;)\n);\u003C/span\u003E";
              APIValues["php"]["tutorial_connect_reuse_customer"] = "\u003Cspan class=\"highlight_js php\"\u003E// Create a Customer\nStripe_Token::create(\n  array(\u0026quot;customer\u0026quot; =\u0026gt; CUSTOMER_ID, \u0026quot;card\u0026quot; =\u0026gt; CARD_ID),\n  ACCESS_TOKEN // user\u0026#39;s access token from the Stripe Connect flow\n);\u003C/span\u003E";
          APIValues["node"] = {};
              APIValues["node"]["tutorial_connect_store_customer"] = "\u003Cspan class=\"highlight_js javascript\"\u003E// Set your secret key: remember to change this to your live secret key in production\n// See your keys here https://dashboard.stripe.com/account\nvar stripe = require(\u0026quot;stripe\u0026quot;)(\u0026quot;sk_test_BQokikJOvBiI2HlWgH4olfQ2\u0026quot;);\n\n// (Assuming you\u0026#39;re using express - expressjs.com)\n// Get the credit card details submitted by the form\nvar tokenID = request.body.stripeToken;\n\n// Create a Customer\nstripe.customers.create({\n  card: tokenID,\n  description: \u0026quot;payinguser@example.com\u0026quot;\n}, function(err, customer) {\n\n});\u003C/span\u003E";
              APIValues["node"]["tutorial_connect_reuse_customer"] = "\u003Cspan class=\"highlight_js javascript\"\u003Estripe.tokens.create(\n  { customer: CUSTOMER_ID, card: CARD_ID },\n  ACCESS_TOKEN, // user\u0026#39;s access token from the Stripe Connect flow\n  function(err, token) {\n    // callback\n  }\n);\u003C/span\u003E";
  </script>


  <script src="../../assets/documentation-6a120856de81b5511bf1790365f19166.js"></script>
  <script src="../../assets/highlight.pack-8bd9d9dd93b5ef1f95e855d7641494d2.js"></script>
<script src="../../assets/highlighter-1268244f129b69592ca48d0f0f198cac.js"></script>

  <script type="text/javascript">
    Analytics.page("docs");
  </script>
</body>

<!-- Mirrored from stripe.com/docs/connect/shared-customers by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 09 Feb 2015 07:33:13 GMT -->
</html>
